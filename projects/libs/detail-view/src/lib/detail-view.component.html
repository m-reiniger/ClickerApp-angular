<article class="detail-view">
    @if (shouldShowCelebration()) {
        <div class="celebration-container">
            @for (item of [].constructor(50); track $index) {
                <div class="confetti"></div>
            }
        </div>
    }
    <mat-card
        class="detail-view-card"
        libSwipeToClose
        scrollContainerId="main"
        [swipeThreshold]="175"
        [swipeDirection]="swipeDirection"
        (closeHandler)="close()">
        <mat-icon class="close" fontIcon="close" (click)="close()"></mat-icon>
        <mat-card-header>
            <h3>{{ counterDetail()?.name }}</h3>
        </mat-card-header>
        <mat-card-content>
            <section class="counter-value">
                <div class="counter-value">
                    <button
                        mat-fab
                        [style.--progress]="
                            getProgress(
                                counterDetail()!.initialValue,
                                counterDetail()!.goal,
                                counterValue()
                            )
                        "
                        [class.goal-reached]="checkGoal(counterDetail()!, counterValue())">
                        {{ counterValue() | number: '1.0-2' }}
                        @if (
                            counterDetail()!.goal !== null && counterDetail()!.goal !== undefined
                        ) {
                            <span class="goal">/{{ counterDetail()!.goal }}</span>
                        }
                    </button>
                </div>
            </section>
            <section class="counter-control">
                <div class="decrement-button">
                    <button mat-fab (click)="decrementCounterHandle($event, counterDetail()?.id)">
                        @if (counterDetail()!.defaultIncrement > 0) {
                            -
                        } @else {
                            +
                        }
                    </button>
                </div>
                <div class="increment-button">
                    <button mat-fab (click)="incrementCounterHandle($event, counterDetail()?.id)">
                        @if (counterDetail()!.defaultIncrement > 0) {
                            +
                        }
                        {{ counterDetail()?.defaultIncrement }}
                    </button>
                </div>
            </section>
            <section class="counter-tools">
                <button mat-fab (click)="confirmDelete()">
                    <span
                        ><mat-icon
                            aria-hidden="false"
                            aria-label="delete"
                            fontIcon="delete"></mat-icon
                    ></span>
                    <span class="counter-tools-label">delete</span>
                </button>
                <button mat-fab (click)="confirmReset()">
                    <span
                        ><mat-icon
                            aria-hidden="false"
                            aria-label="reset"
                            fontIcon="restart_alt"></mat-icon
                    ></span>
                    <span class="counter-tools-label">reset</span>
                </button>
                <button mat-fab (click)="editCounterHandle($event, counterDetail()?.id)">
                    <span
                        ><mat-icon aria-hidden="false" aria-label="edit" fontIcon="edit"></mat-icon
                    ></span>
                    <span class="counter-tools-label">&nbsp;edit&nbsp;</span>
                </button>
                <button mat-fab (click)="showHistoryHandle($event, counterDetail()?.id)">
                    <span
                        ><mat-icon
                            aria-hidden="false"
                            aria-label="history"
                            fontIcon="history"></mat-icon
                    ></span>
                    <span class="counter-tools-label">history</span>
                </button>
            </section>
        </mat-card-content>
    </mat-card>
</article>
