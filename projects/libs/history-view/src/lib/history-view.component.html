<article class="history-view">
    <mat-card
        class="history-card"
        libSwipeToClose
        scrollContainerId="main"
        [swipeThreshold]="175"
        (closeHandler)="close()">
        <mat-icon class="close" fontIcon="close" (click)="close()"></mat-icon>
        <mat-card-header>
            <h3>{{ counterName }}</h3>
        </mat-card-header>
        <mat-card-content>
            <section class="history-list">
                <mat-list>
                    @for (transaction of sortedTransactions(); track transaction.timestamp) {
                        <mat-list-item class="{{ getOperationColor(transaction.operation) }}">
                            <div matListItemTitle>
                                <button mat-fab>
                                    {{ transaction.currentValue | number: '1.0-2' }}
                                </button>
                                <span class="operation">
                                    @if (
                                        transaction.operation === 'add' ||
                                        transaction.operation === 'subtract'
                                    ) {
                                        {{
                                            getOperationText(
                                                transaction.operation,
                                                transaction.value
                                            )
                                        }}
                                    } @else if (transaction.operation === 'reset') {
                                        <mat-icon>restart_alt</mat-icon>
                                    } @else {
                                        <mat-icon>photo_camera</mat-icon>
                                    }
                                </span>
                                <span class="timestamp">
                                    @if (isCurrentYear(transaction.timestamp)) {
                                        {{ transaction.timestamp | date: 'MMM d, HH:mm' }}
                                    } @else {
                                        {{ transaction.timestamp | date: 'MMM d, yyyy, HH:mm' }}
                                    }
                                </span>
                                <span class="time-difference">
                                    ({{ transaction.timeSincePrevious }})
                                </span>
                            </div>
                        </mat-list-item>
                    } @empty {
                        <mat-list-item>
                            <div matListItemTitle>No transactions yet</div>
                        </mat-list-item>
                    }
                </mat-list>
            </section>
        </mat-card-content>
    </mat-card>
    @if (showScrollToTop()) {
        <button mat-fab class="scroll-to-top" (click)="scrollToTop()" aria-label="Scroll to top">
            <mat-icon>arrow_upward</mat-icon>
        </button>
    }
</article>
