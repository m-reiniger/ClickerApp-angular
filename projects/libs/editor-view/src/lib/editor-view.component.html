<article class="editor-view">
    <mat-card
        class="editor-view-card"
        libSwipeToClose
        scrollContainerId="main"
        [swipeThreshold]="175"
        (closeHandler)="close()">
        <mat-icon class="close" fontIcon="close" (click)="close()"></mat-icon>
        <mat-card-header>
            <h3 class="form-title">{{ title }}</h3>
        </mat-card-header>
        <mat-card-content>
            <form [formGroup]="counterForm" class="editor-view-form">
                <div class="form-section">
                    <mat-form-field class="editor-view-field">
                        <mat-label>Name</mat-label>
                        <input
                            matInput
                            formControlName="name"
                            placeholder="e.g., Weekly Workouts" />
                        @if (counterForm.get('name')?.hasError('required')) {
                            <mat-error>Name is required</mat-error>
                        }
                    </mat-form-field>

                    <div class="color-picker">
                        <label class="color-picker-label">Counter Color</label>
                        <div class="color-options">
                            @for (color of colorOptions; track color.value) {
                                <button
                                    type="button"
                                    class="color-option"
                                    [style.background-color]="color.value"
                                    [class.selected]="selectedColor === color.value"
                                    (click)="selectColor(color.value)"
                                    [attr.aria-label]="color.name">
                                    @if (selectedColor === color.value) {
                                        <mat-icon>check</mat-icon>
                                    }
                                </button>
                            }
                        </div>
                    </div>

                    @if (!editMode) {
                        <mat-form-field class="editor-view-field">
                            <mat-label>Initial Value</mat-label>
                            <input matInput formControlName="initialValue" type="number" />
                            <mat-hint>Counter starting value</mat-hint>
                            @if (counterForm.get('initialValue')?.hasError('required')) {
                                <mat-error>Initial value is required</mat-error>
                            }
                        </mat-form-field>
                    }

                    <mat-form-field class="editor-view-field">
                        <mat-label>Default Increment</mat-label>
                        <input matInput formControlName="defaultIncrement" type="number" />
                        <mat-hint>Amount to increase by each click</mat-hint>
                        @if (counterForm.get('defaultIncrement')?.hasError('required')) {
                            <mat-error>Default increment is required</mat-error>
                        }
                    </mat-form-field>

                    <mat-form-field class="editor-view-field">
                        <mat-label>Goal</mat-label>
                        <input matInput formControlName="goal" type="number" />
                        <mat-hint>Set a target value for this counter</mat-hint>
                    </mat-form-field>
                </div>

                <div class="action-button">
                    <button mat-flat-button (click)="saveCounter()" type="button">
                        <mat-icon>{{ editMode ? 'save' : 'add' }}</mat-icon>
                        <span>{{ editMode ? 'Save Changes' : 'Create Counter' }}</span>
                    </button>
                </div>
            </form>
        </mat-card-content>
    </mat-card>
</article>
