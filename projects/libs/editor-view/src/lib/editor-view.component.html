<article class="editor-view">
    <mat-card
        class="editor-view-card"
        libSwipeToClose
        scrollContainerId="main"
        [swipeThreshold]="175"
        (closeHandler)="close()">
        <mat-icon class="close" fontIcon="close" (click)="close()"></mat-icon>
        <mat-card-header>
            <h3 class="form-title">{{ title }}</h3>
        </mat-card-header>
        <mat-card-content>
            <form [formGroup]="counterForm" class="editor-view-form">
                <mat-accordion>
                    <mat-expansion-panel expanded>
                        <mat-expansion-panel-header>
                            <mat-panel-title>Counter Details</mat-panel-title>
                        </mat-expansion-panel-header>
                        <mat-form-field class="editor-view-field">
                            <mat-label>Name</mat-label>
                            <input
                                matInput
                                formControlName="name"
                                placeholder="e.g., Daily Workouts" />
                            @if (counterForm.get('name')?.hasError('required')) {
                                <mat-error>Name is required</mat-error>
                            }
                        </mat-form-field>
                    </mat-expansion-panel>

                    <mat-expansion-panel class="options-panel">
                        <mat-expansion-panel-header>
                            <mat-panel-title class="options-title">More options</mat-panel-title>
                        </mat-expansion-panel-header>

                        @if (!editMode) {
                            <mat-form-field class="editor-view-field">
                                <mat-label>Initial Value</mat-label>
                                <input matInput formControlName="initialValue" type="number" />
                                <mat-hint>Your counter will start at this value</mat-hint>
                                @if (counterForm.get('initialValue')?.hasError('required')) {
                                    <mat-error>Initial value is required</mat-error>
                                }
                            </mat-form-field>
                        }

                        <mat-form-field class="editor-view-field">
                            <mat-label>Default Increment</mat-label>
                            <input matInput formControlName="defaultIncrement" type="number" />
                            <mat-hint>The amount to increase/decrease by each click</mat-hint>
                            @if (counterForm.get('defaultIncrement')?.hasError('required')) {
                                <mat-error>Default increment is required</mat-error>
                            }
                        </mat-form-field>

                        <mat-form-field class="editor-view-field">
                            <mat-label>Goal</mat-label>
                            <input matInput formControlName="goal" type="number" />
                            <mat-hint>Set a target value for this counter</mat-hint>
                        </mat-form-field>
                    </mat-expansion-panel>
                </mat-accordion>

                <div class="action-button">
                    <button mat-flat-button (click)="saveCounter()" type="button">
                        <mat-icon>{{ editMode ? 'save' : 'add' }}</mat-icon>
                        <span>{{ editMode ? 'Save Changes' : 'Create Counter' }}</span>
                    </button>
                </div>
            </form>
        </mat-card-content>
    </mat-card>
</article>
